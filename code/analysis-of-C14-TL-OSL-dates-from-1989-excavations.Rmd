---
title: ""
author: Ben Marwick
date: Thursday, June 26, 2014
output: html_document
---

# Supplementary details supporting the analysis of ages from the 1989 excavations at Madjebebe (Malakanunja II)


```{r read-in-data}
# plot all dates for 1989 paper, colour by method
# raw data from text table in....
directory <- "E:/My Documents/My UW/Research/1206 M2 excavation/Malakunanga 89 excavations/MJB-1989-excavation-paper/data"
dates_1989 <- read.csv(paste0(directory, "/Date_table_from_paper_on_1989_dig.csv"))
```


```{r clean-up}
# clean up depth, where there's a range, get midpoint
# get depths with ranges, ie nn-nn
depthwithrange <- as.character(dates_1989$Depth.cm [grepl("-", dates_1989$Depth.cm )])
# find midpoint
midpoint <- unlist(lapply(depthwithrange, function(i) abs(eval(parse(text= i)))))/2 + # get half of range
as.numeric(gsub("-.*", "", depthwithrange)) # depth value 
# replace depth with range with single depth value
dates_1989$Depth.cm <- as.character(dates_1989$Depth.cm)
dates_1989$Depth.cm[grep("-", dates_1989$Depth.cm)] <- midpoint
dates_1989$Depth.m <- as.numeric(dates_1989$Depth.cm)/100 # in meters

# get the median value from OxCal output
oxcal_medians <- read.csv(paste0(directory, "/Date_table_from_paper_on_1989_dig_C14_OxCal_output.csv"))

# get lab sample ID for matching
matching <- c("R_Date", " ")
oxcal_medians$Name <- gsub(paste(matching, collapse = "|"), "", oxcal_medians$Name)

# get rid of spaces and convert to same type
dates_1989$Lab.Code <- as.character(gsub(" ", "", dates_1989$Lab.Code))
dates_1989$Method <- as.character(gsub(" ", "", dates_1989$Method))

dates_1989_with_C14_medians <- merge(x = dates_1989, 
      y = oxcal_medians, 
      by.x = "Lab.Code", 
      by.y = "Name",
      all = TRUE)
# remove header row
dates_1989_with_C14_medians <- dates_1989_with_C14_medians[-1,]

# in kya
dates_1989_with_C14_medians$age2plot <- (ifelse(dates_1989_with_C14_medians$Method == "TL"|dates_1989_with_C14_medians$Method == "OSL", dates_1989_with_C14_medians$Uncalibrated.Age, ifelse(dates_1989_with_C14_medians$Method == "C14"| dates_1989_with_C14_medians$Method == "ABOX", as.numeric(as.character(dates_1989_with_C14_medians$X.3)), NA)))/1000

# simplify object name
dates_1989 <- dates_1989_with_C14_medians
```


```{r interpolate}

# interpolate age from loess line with depth
# this is for the lines that show oldest artefact, etc.
cal.date.lo <- loess(age2plot ~ Depth.m, dates_1989[dates_1989$Method %in% c("C14", "TL", "OSL"),] , span = 0.4) # exclude ABOX dates
cal.date.pr <- predict(cal.date.lo, data.frame(Depth.m = seq(0, 5, 0.01)))
# plot(cal.date.pr) # just to check
cal.date.pr <- data.frame(age = cal.date.pr, depth = names(cal.date.pr))
# determine an age from a known depth
oldest_depth = 287 # depth in cm, to the nearest 1 cm: oldest artefacts
oldest <- cal.date.pr[cal.date.pr$depth == oldest_depth,]$age # returns age from loess
base_of_dense_depth = 250 # depth in cm, to the nearest 1 cm: base of dense artefacts
dense <- cal.date.pr[cal.date.pr$depth == base_of_dense_depth,]$age # returns age from loess
```

```{r plot-dates}
library(ggplot2)
limits <- aes(ymax = age2plot  + Error/1000, ymin = age2plot  - Error/1000, colour = factor(Method))
library(scales) # needed for axis number format
ggplot(dates_1989, aes(Depth.m, age2plot, , label = Lab.Code)) + 
  # add loess line that excludes the ABOX dates
  geom_smooth(data =  dates_1989[dates_1989$Method %in% c("C14", "TL", "OSL"),]  , method = "loess", se = FALSE, span = 0.5, colour = "grey", alpha = 0.2, size = 1) +
  # set point size, colour and shape
  geom_point(size = 2, aes(colour = factor(Method), shape = factor(Method))) + 
  # add error bars
  geom_linerange(limits, width=0.5) +
  # add lab codes as point labels
  geom_text(angle = 0,  hjust = -0.2, vjust = 0.2, size = 2) +
  # Edit axis labels
  xlab("meters below surface") + ylab("x 1000 years cal. BP") +
  # scale title
  scale_colour_discrete(name  ="Dating\nmethod" ) + 
  scale_shape_discrete(name  ="Dating\nmethod" ) +
  # format y axis for readability
  scale_y_continuous(labels = comma, breaks = seq(0,100,20)) + 
  scale_x_reverse() + # top to bottom of the trench
  # lines for lowest artefacts at 2.8 m
  annotate("segment", x = oldest_depth/100, y = oldest, xend = -4.75, yend = oldest, colour = "grey30") +
  annotate("segment",x = oldest_depth/100, y = 0, xend = -oldest_depth/100, yend = oldest, colour = "grey30") +
  annotate("text", x = 3, y = 15, label = paste0("lowest artefacts (", round(oldest,0), " ka BP)"), size = 3) +
  # lines for dense concentration at 2.5 m
  annotate("segment", x = base_of_dense_depth/100, y = dense, xend = -4.75, yend = dense, colour = "grey30") +
  annotate("segment", x = base_of_dense_depth/100, y = 0, xend = -base_of_dense_depth/100, yend = dense, , colour = "grey30") +
  annotate("text", x = 2.5, y = 15, label = paste0("base of dense \noccupation layer (", round(dense,0), " ka BP)"), size = 3) +
  
  theme_bw() +
  coord_flip() + # rotate
  # format non-data elements
  theme(# panel.background = element_blank(),        # suppress default background
    # panel.grid.major = element_blank(),            # suppress default major gridlines
    # panel.grid.minor = element_blank(),            # suppress default minor gridlines
    # axis.ticks = element_blank(),                  # suppress tick marks
    axis.title.x=element_text(size=17),              # increase axis title size slightly  
    axis.title.y=element_text(size=17, angle=90),    # increase axis title size slightly and rotate
    axis.text.x=element_text(size=15, colour = "black"),    # increase size of numbers on x-axis
    axis.text.y=element_text(size=15, colour = "black"))    # increase size of numbers on y-axis
#  aspect.ratio=0.5 )                                 # make the plot square-ish


# save plot as SVG for finessing...
ggsave(file=paste0(directory, "MKII_dates_from_1989_for_paper.svg"), width = 200, height = 200, units = "mm")
# the some minor edits in inkscape to make the data point labels more readable
```

```{r difference-in-slope-plot}

summary(OSL_mod <- lm(age2plot ~ Depth.m, data=OSL)) # 
summary(C14_mod <- lm(age2plot ~ Depth.m, data=C14)) #
# diff in slopes over
# the standard error of the difference between the two slopes
dates_1989$Two_methods <- ifelse(dates_1989$Method == "TL"|dates_1989$Method == "OSL", "OSL/TL", ifelse(dates_1989$Method == "C14"| dates_1989$Method == "ABOX", "C14", "NA"))

# plot
library(ggplot2)
ggplot(dates_1989, aes(age2plot, Depth.m, colour = Two_methods)) +
  geom_point(size = 1) +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal(base_size = 14) +
  scale_y_reverse() + 
  geom_text(aes(label = Lab.Code), size = 3, hjust=1, vjust=1) + 
  ylab("meters below surface") + xlab("x 1000 years cal. BP") 
```

Plotting the linear regression lines for OSL/TL ages against radiocarbon ages suggests that the slopes of the lines are not the same. We can explore this further by comparing the models directly.

```{r difference-in-slope-1}
# Looking into the question of difference in slope of 
# regression lines using data from 1989

# separate OSL and C14 dates to test for slope for paper on 1989 data
OSL_TL <- dates_1989[grepl("TL", dates_1989$Two_methods),]
C14 <- dates_1989[!grepl("TL", dates_1989$Two_methods),]

# investigate regressions of depth-age by method
summary(m1 <- aov( Depth.m ~ age2plot * Two_methods, data = dates_1989))
# significant difference interaction, These results suggest that the slope of the regression between date and depth width is not similar for the two dating methods.
```

Computing a linear model with depth and age using the two dating methods as a cross to test for interaction between them gives a significant difference, with a p-value of `r round(anova(m1)$`Pr(>F)`[3],3)`. 

```{r  difference-in-slope-2}
# now limit to upper 178 cm
upper <- dates_1989[dates_1989$Depth.m < 2, ]

# investigate regressions of depth-age by method
# from 
# http://stats.stackexchange.com/a/18397/7744 and 
# http://r-eco-evo.blogspot.com/2011/08/comparing-two-regression-slopes-by.html
# and Teetor, P. 2011 R Cookbook, O'Reilly.  p 309-311. 

summary(m2 <- aov( Depth.m ~ age2plot * Two_methods, data = upper))

# NO significant difference interaction at <2m bs, These results suggest that the slope of the regression between cal.date and depth width is not similar for the two dating methods. 
```

If we restrict the sample to just the dates in the upper 2 m, which is the depth of the lowest in-sequence radiocarbon date (SUA-265), we can more robustly compare the ages from radiocabon and luminesensce methods. 

In the ANCOVA model, age is modeled as the dependent variable with depth as the factor and dating method as the covariate. The summary of the results show a significant effect of depth (p = `r sprintf("%.5f",anova(m2)$`Pr(>F)`[1])`, but no significant interaction between dating methods (p = `r sprintf("%.3f",anova(m2)$`Pr(>F)`[3])`. These results suggest that the slope of the regression between age and depth is similar for both dating methods.

```{r difference-in-slope-3}

# more parsimonious model is fit without the interaction to test for a significant differences in the slope. 
summary(m3 <- aov( Depth.m ~ age2plot + Two_methods, data = upper))

m2m3 <- anova(m2,m3)
# removing the interaction DOES NOT significantly affect the fit of the model.  We observe that for the dates, the method has a NO significant  effect on age and the effect is NOT different for C14 and OSL 
```

We can fit a more parsimonious model without the interaction to test for significant differences in slope. We can compare the two models for each dating method with ANOVA to assess if removing the interaction significantly affects the fit of the model. The result is that removing the interaction does not significantly effect the fit of the model. There is still no significant effect of dating method on the slope of the age-depth lines (p = `r sprintf("%.3f",anova(m2, m3)$`Pr(>F)`[2])`)

```{r difference-in-slope-4}

# Is there a difference in slopes of the regression line in the 
# two methods?
summary(OSL_TL_mod <- lm(age2plot ~ Depth.m, data=OSL_TL)) # 
summary(C14_mod <- lm(age2plot ~ Depth.m, data=C14)) # 
# plot(age2plot ~ Depth.m, data=OSL_TL, col = "green")
# points(age2plot ~ Depth.m, data=C14, col = "red")
# abline(OSL_TL_mod, col = "green")
# abline(C14_mod, col = "red")

# Using the procedure developed by R. A. Fisher in 1921 (On the probable error # # of a coefficient of correlation deduced from a small sample, Metron, 1, 3-32)

# get r values
OSL_TL_mod_slope <- summary(OSL_TL_mod)[[4]][2,1]
C14_mod_slope <- summary(C14_mod)[[4]][2,1]

# copmute r-prime
OSL_TL_mod_slope1 <- 0.5 * (log(  abs((1+OSL_TL_mod_slope) / (1-OSL_TL_mod_slope) ) ) )
C14_mod_slope1 <- 0.5 * (log(  abs((1+C14_mod_slope) / (1-C14_mod_slope) ) ) )

# compute z
z <- (OSL_TL_mod_slope1 - C14_mod_slope1) / sqrt ( (1/(nrow(OSL_TL) - 3) + 1/(nrow(C14) - 3)))

# p from z
p_value <- 2*pnorm(-abs(z))
```

The slope values are `r round(OSL_TL_mod_slope,2)` for the OSL/TL dates and `r round(C14_mod_slope,2)` for the C14 dates. Fisher's method suggests there is no difference with p = `r p_value` for the difference between slopes. 

```{r difference-in-slope-bayes-1} 
# now do Bayesian approach... 
library(MCMCpack)
posterior1 <- (MCMCregress(age2plot ~ Depth.m, data=OSL_TL))
# windows()
# plot(posterior1)
raftery.diag(posterior1)
summary(posterior1)

# intercept
# hist(posterior1[,1])
# x1 (ie. slope)
hist(posterior1[,2], main = parse(text='Slope~of~OSL'))
# get distribution of slope
x1_post <- as.numeric(posterior1[,2])
# this is a bit absurd because just two data points...
# let's trim it a bit, cf. https://stat.ethz.ch/pipermail/r-help/2010-August/247632.html
# .limit <- quantile(x1_post, prob=c(.45, .55))
# trm <- subset(x1_post, x1_post >= .limit[1] & x1_post <= .limit[2])
# quantile(trm) # check to see if we've removed some of the extreme values
# x1_post <- trm
# hist(x1_post)

posterior2 <- (MCMCregress(age2plot ~ Depth.m, data=C14))
# windows()
# plot(posterior2)
raftery.diag(posterior2)
summary(posterior2)

# intercept
# hist(posterior2[,1])
# x1 (ie. slope)
hist(posterior2[,2], main = parse(text='Slope~of~""^14*C'))
# get distribution of slope
x2_post <- as.numeric(posterior2[,2])
```


```{r difference-in-slope-bayes-2}
# now compare the two distributions of slopes

# BEST http://www.indiana.edu/~kruschke/BEST/
# devtools::install_github('mikemeredith/BEST')
library(BEST)
slopes_test <- BESTmcmc(x1_post, x2_post, verbose = TRUE)
summary(slopes_test)
print(slopes_test)
plot(slopes_test)
windows()
plotAll(slopes_test, credMass=0.8, ROPEm=c(-0.1,0.1), 
        ROPEeff=c(-0.2,0.2), compValm=0.5) 
pairs(slopes_test)
# key output is muDiff from summary
# http://cran.r-project.org/web/packages/BEST/vignettes/BEST.pdf
# since this a time-consume analysis, here's the out put as of
# 27 Jun 2014
#             mean median   mode HDI% HDIlo  HDIup compVal %>compVal
# mu1       24.699 24.699 24.699   95 24.69 24.711                  
# mu2        7.607  7.607  7.608   95  7.57  7.642                  
# muDiff    17.092 17.092 17.089   95 17.05 17.129       0       100
# sigma1     0.168  0.168  0.168   95  0.16  0.176                  
# sigma2     1.684  1.684  1.685   95  1.65  1.720                  
# sigmaDiff -1.516 -1.516 -1.518   95 -1.55 -1.479       0         0
# nu        12.176 12.072 11.807   95  9.92 14.601                  
# log10nu    1.083  1.082  1.079   95  1.00  1.169                  
# effSz     14.289 14.287 14.278   95 13.98 14.605       0       100
# 
# the diff in means seems very high, 17, and excludes zero, which is what we'd describe as significant... that's at odds with the other methods... redo it without the trimming

# plot
library(ggplot2)
ggplot(upper, aes(age2plot, Depth.m, colour = Two_methods)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal(base_size = 14) +
  scale_y_reverse()
```

A test of the difference between the correlation coefficients for the linear regression slopes for 14C and luminescence ages indicates no significant difference between slopes, indicating that both provide effectively identical age-depth relationships for the uppermost two meters of deposit (Bayesian estimation of difference in means = `r round(summary(slopes_test)[3], 2)`, 95% HDI = `r round(unname(summary(slopes_test)[3, 5:6]),2)`).


```{r change-point-analysis}
#### bayesian change point analysis on sedimentation rates

library(bcp)


# interpolate age from loess line with depth
# this is for the lines that show oldest artefact, etc.
cal.date.lo <- loess(age2plot ~ Depth.m, dates_1989[dates_1989$Method %in% c("C14", "TL", "OSL"),] , span = 0.4) # exclude ABOX dates
cal.date.pr <- predict(cal.date.lo, data.frame(Depth.m = seq(0, 5, 0.01)))
plot(cal.date.pr)
cal.date.pr <- data.frame(age = cal.date.pr, depth = names(cal.date.pr))

# do cp analysis on loess line
cp <- bcp(as.numeric(na.omit(cal.date.pr$age)))
plot(cp)
legacyplot(cp)

# do cp analysis on dates 
cp <- bcp(as.numeric(dates_1989[dates_1989$Method %in% c("C14", "TL", "OSL"),]$age2plot))
plot(cp)
legacyplot(cp)
cp

# what samples are at these change points?
dates_no_ABOX <- dates_1989[dates_1989$Method %in% c("C14", "TL", "OSL"),]
cbind(dates_no_ABOX, cp$posterior.prob)

# slope from KTL97 through KTL165 compare C14 to OSL

# now limit for depth range KTL97 through KTL165

# get depths of those dates
KTL97_depth <- dates_1989[dates_1989$Lab.Code == "KTL97", ]$Depth.m
# two values for KTL162, both the same, let's just get one
KTL165_depth <- dates_1989[dates_1989$Lab.Code == "KTL165", ]$Depth.m[1]

# subset all dates in the region of KTL97 - KTL165
sub <- dates_1989[dates_1989$Depth.m %in% seq(1.550,1.900,0.001), ]


# separate OSL and C14 dates to test for slope
sub$Method <- ifelse(grepl("TL", sub$Method), "OSL", "C14")
OSL <- sub[grepl("OSL", sub$Method),]
C14 <- sub[!grepl("OSL", sub$Method),]

# investigate regressions of depth-age by method
# from http://r-eco-evo.blogspot.com/2011/08/comparing-two-regression-slopes-by.html
summary(m1 <- aov( Depth.m ~ age2plot * Method, data = sub))
# NO significant difference interaction, These results suggest that the slope of the regression between cal.date and depth width is not similar for the two dating methods. 

# more parsimonious model is fit without the interaction to test for a significant differences in the slope. 
summary(m2 <- aov( Depth.m ~ age2plot + Method, data = sub))

anova(m1,m2)
# removing the interaction DOES NOT significantly affect the fit of the model.  We observe that for the dates, the method has a NO significant  effect on age and the effect is NOT different for C14 and OSL 

# Is there a difference in slopes of the regression line in the 
# two methods
# this approach is from http://core.ecu.edu/psyc/wuenschk/docs30/CompareCorrCoeff.pdf
summary(OSL_mod <- lm(age2plot ~ Depth.m, data=OSL)) # 
summary(C14_mod <- lm(age2plot ~ Depth.m, data=C14)) # 
# diff in slopes over
# the standard error of the difference between the two slopes

b1 <- coef(OSL_mod)["Depth.m"] 
b2 <- coef(C14_mod)["Depth.m"]
s1 <- 0 # summary(OSL_mod)$coefficients[2,2]
s2 <- summary(C14_mod)$coefficients[2,2]

t <- abs(b1 - b2)/ sqrt(abs(s1^2 - s2^2))
(pval <- 2*pt(t, nrow(sub), lower=FALSE)) 

# not very useful since onlye two data points...
# C14 dates have higher intercept, so they are greater


# now do Bayesian approach... 
library(MCMCpack)
posterior1 <- (MCMCregress(age2plot ~ Depth.m, data=OSL))
# windows()
plot(posterior1)
raftery.diag(posterior1)
summary(posterior1)

# intercept
hist(posterior1[,1])
# x1 (ie. slope)
hist(posterior1[,2])
# get distribution of slope
x1_post <- as.numeric(posterior1[,2])
# this is a bit absurd because just two data points...
# let's trim it a bit, cf. https://stat.ethz.ch/pipermail/r-help/2010-August/247632.html
.limit <- quantile(x1_post, prob=c(.45, .55))
trm <- subset(x1_post, x1_post >= .limit[1] & x1_post <= .limit[2])
quantile(trm) # check to see if we've removed some of the extreme values
x1_post <- trm

posterior2 <- (MCMCregress(age2plot ~ Depth.m, data=C14))
# windows()
plot(posterior2)
raftery.diag(posterior2)
summary(posterior2)

# intercept
hist(posterior2[,1])
# x1 (ie. slope)
hist(posterior2[,2])
# get distribution of slope
x2_post <- as.numeric(posterior2[,2])
# this is a bit absurd because just two data points...
# let's trim it a bit, cf. https://stat.ethz.ch/pipermail/r-help/2010-August/247632.html
.limit <- quantile(x2_post, prob=c(.45, .55))
trm <- subset(x2_post, x2_post >= .limit[1] & x2_post <= .limit[2])
quantile(trm) # check to see if we've removed some of the extreme values
x2_post <- trm

# now compare the two distributions of slopes


# BEST http://www.indiana.edu/~kruschke/BEST/
# devtools::install_github('mikemeredith/BEST')
library(BEST)
slopes_test <- BESTmcmc(x1_post, x2_post, verbose = TRUE)
summary(slopes_test)
print(slopes_test)
plot(slopes_test)
windows()
plotAll(slopes_test, credMass=0.8, ROPEm=c(-0.1,0.1), 
        ROPEeff=c(-0.2,0.2), compValm=0.5) 
pairs(slopes_test)


# plot
library(ggplot2)
ggplot(sub, aes(age2plot, Depth.m, colour = Method)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal(base_size = 14) +
  scale_y_reverse()
```





```{r}
################################################################################
# interpolate age from loess line with depth
cal.date.lo <- loess(age2plot ~ Depth.m, dates_1989)
cal.date.pr <- predict(cal.date.lo, data.frame(Depth.m = seq(0, 5, 0.01)))
plot(cal.date.pr)
cal.date.pr <- data.frame(age = cal.date.pr, depth = names(cal.date.pr))
# determine an age from a known depth
i = 280 # depth in cm, to the nearest 1 cm
cal.date.pr[cal.date.pr$depth == i,] # returns age from loess



# interpolate depth from loess line with age
cal.date.lo <- loess(age2plot ~ Depth.m, dates_1989)
cal.date.pr <- predict(cal.date.lo, data.frame(Depth.m = seq(0, 100000, 1000)))
plot(cal.date.pr)
cal.date.pr <- data.frame(depth = cal.date.pr, age = names(cal.date.pr))
# determine an depth from a known age
i = 54 # age in kya,
cal.date.pr[cal.date.pr$cal.date == i,] # returns depth from loess, in m



# change point analysis on linear regression residuals
c14_all.lm <- with(c14_all, lm(depth ~ cal.date))
layout(matrix(1:4,2,2))
plot(c14_all.lm)
dev.off()
plot(c14_all.lm$residuals ~ c14_all.lm$fitted.values)

library(bcp)
c14_all.bcp <- bcp(c14_all.lm$residuals, w0 = 0.2, p0 = 0.2, burnin = 50, mcmc = 500, return.mcmc = FALSE)
plot(c14_all.bcp)

library(strucchange)
efp <- efp(depth ~ cal.date, c14_all,type = "OLS-CUSUM")
plot(efp(depth ~ cal.date, c14_all, type = "OLS-CUSUM"))
plot(Fstats(depth ~ cal.date, data=c14_all))
```



## The Revised Chronology 

Based on the TL age estimates and the artefact distribution, Roberts et al. (1990a) suggested first occupation at the site began 55 ± 5 ka. Although the excavators were conservative in their interpretations—stressing the upper (i.e. 50 ka) limit of this age range and taking the lower limit of the high density band of artefacts (2.4 m bs) as the actual level of initial occupation — we confirm here that the lowest artefacts occur in Spit 49, 2.76 – 2.8 m deep below surface and are bracketed by the original OSL age estimate of 55.5 ± 8.2 ka (KTL-162) and the TL estimate of 65 ± 14 ka (KTL-141). Subsequent redating of several of the lower samples at MJB using single grain and single aliquot OSL methods reduced the error ranges for the lower dates substantially, but did not alter the original results (Roberts et al. 1998). 

At the time of Roberts et al.’s (1998) publication and commentary no calibration curve was available for radiocarbon dates greater than 11 ka, and hence the issue of underestimation of calendar years could not be resolved. A calibration curve is now available back to 50 ka (Reimer et al. 2013). The IntCal13 calibration curve results in a calibrated age for the 13.39 ka age (ANU-7006) as 15,001 – 17,429 cal BP, overlapping at 1σ with the TL age of 15 ± 3 ka (KTL-165) at equivalent depth. Kamminga and Allen’s (1973) 18.04 ka age (SUA-265)    calibrates to c. 22.4 - 21.0 ka, overlapping at 1σ with the TL age of 24 ± 5 ka (KTL-97) at equivalent depth. The 14.9 ka age (ANU-7007) provided by Roberts et al. (1998) calibrates to 18.5 - 17.8 ka, and remains within 1σ of the TL age of KTL-97. These new calibrations show that conventional radiocarbon years do substantially under-estimate the ages of the sediments and that calendar ages show a strong correlation with luminescence ages. 

Smith and Jones obtained several more radiocarbon dates that have not been previously published (Table 1), increasing the number of available radiocarbon ages for the site to 13. With the exception of one anomalous age from the base of the sequence already discussed above (ANUA-9915), the additional 14C ages provide a picture of consistent depth-age relationships between radiocarbon and luminescence techniques down to two meters below the surface (the depth of the lowest in-sequence radiocarbon date). A test of the difference between the correlation coefficients for the linear regression slopes for 14C and luminescence ages indicates no significant difference between slopes, indicating that both provide effectively identical age-depth relationships for the uppermost two meters of deposit (Bayesian estimation of difference in means = -0.309, 95% HDI - 8.27 – 0.020). Concerns over the degree of fit between 14C and luminescence chronologies for the upper half of the deposit can no longer be sustained (cf. Bowdler 1990; Hiscock 1990). 

The full suite of available 14C and luminescence ages for the site are both shown in Figure 5. The locally weighted regression line of best fit for these dates shows several changes in sedimentation rate but no obvious hiatus. Bayesian change point analysis indicates that sedimentation rates slow substantially below 2.0 m to the base of occupation (posterior probability of change is 0.934 at 24 ka cal BP) and then accelerate again below the lowest occupation (posterior probability of change is 0.922 at 65 ka). Sedimentation rates indicated by 14C and OSL ages during the period 15 – 20 ka, just before the first major change in sedimentation rates, are not credibly different (Bayesian estimation of difference in means = 3.7, 95% HDI -2.13 – 9.38). Although there are no reliable 14C ages older than 20 ka, the lack of difference in rates between the two methods before this time suggests that the change in sedimentation rates was a real event, rather than an effect of changes in the age-depth relationship between 14C and luminescence methods. The depth-age curve also allows us to estimate the likely age of the lowest artefact as approximately 64 ka, and the base of the dense artefact layer as approximately 55 ka (though it must be acknowledged, that the error ranges on these lowest luminescence ages are large). Any possible refinement of temporal resolution cannot be addressed prior to analysis of new samples collected in 2012. Non-local stone in the form of silcrete is present from Spit 47 (2.9m bs), suggesting human activity at this level, but artefact numbers do not increase markedly until Spit 45. 

 





