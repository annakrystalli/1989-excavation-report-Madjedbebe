--
title: ""
author: Ben Marwick
date: Thursday, June 26, 2014
output: html_document
---

# Supplementary details supporting the analysis of lithics from the 1989 excavations at Madjebebe (Malakanunja II)

```{r load-data, echo=FALSE}
lithics_data <- get_lithics_data()
chrono_data <- get_chrono_data()
```

```{r clean-up}
chrono_data_tidied <- tidy_chrono_data(chrono_data)
```

```{r interpolate}
chrono_data_interpolated <- interpolate_chrono_data(chrono_data_tidied)
```

```{r clean-data}
# Now onto the lithic data...
lithics_data_cleaned <- clean_lithics_data(lithics_data)
```


```{r plot-data}
lithics_data_plotted <- plots_lithics_data(lithics_data)
lithics_data_plotted$p1
# figures/lithics_over_time_from_1989_for_paper.svg
```

Stone artefacts are present in every spit of the 1989 excavation at MJB (Figure 6, Table 2). These show distinct pulses of accumulation, centred around 5, 7, 12.5, 18.4, 36, and 45 – 52 ka (Figure 6). Between Spits 37 – 39 (2.2 – 2.4 m bs) there are 1900 flaked stone artefacts from the 7 mm sieve (including 41 of exotic chert), numerous pieces of high-grade haematite (totalling 4.92 kg, including seven ground pieces), 143 g of red or yellow ochre, pieces of dolerite (presumed to be fragments of edge-ground axes) and fragments of grindstones; a further 568 flaked stone artefacts and 344 pieces of haematite were recovered from the pit fill at this level. All of these are associated with, or are slightly beneath, a TL age of 45 ± 9 ka. Beneath this, in levels dating 52 ± 11 to 61 ± 13 ka there were an additional 82 flaked stone artefacts and 52 pieces of haematite recovered from the 7 mm sieve. This is a comparatively large assemblage from a trench measuring only 1 x 1.5 m. It is unlikely the quartzite stone artefacts derive from downward displacement of artefacts from the predominately quartz assemblage that overlies it.  

```{r raw-materials}

```


```{r}
require(analogue)
strat_plot <- plot2[,-c(1, 2, 7, 8)]
# get pit ages for zone labels
Zones <- plot2[plot2$Spit %in% c(41, 43), ]$age
Stratiplot(age ~ . , 
           data = strat_plot,
           type = c("h","g"), 
           sort = "wa", 
           zones = Zones, 
           zoneNames = c("lower", "pit", "upper"))

require("rioja")
# stratigraphically constrained cluster analysis
diss <- dist(strat_plot[,-ncol(strat_plot)])
clust <- chclust(diss, method = "coniss")

# remove NA d[is.na(d)] <- 0
strat_plot[is.na(strat_plot)] <- 0


x <- strat.plot(strat_plot[,-ncol(strat_plot)] * 100,
                    yvar = as.numeric(strat_plot$age),
                    ylim = range(strat_plot$age, na.rm=TRUE),
                    y.rev = TRUE,
                    ylabel = "Age",
                    col.bar = "black",
                    lwd.bar = 5,
                    plot.line = FALSE, # if TRUE, fiddle with col and lwd
                    col.line = "white", # try others that you like
                    lwd.line = 1,    # ditto
                    scale.percent = TRUE,
                    clust = clust
                    )
addZone(x, Zones, col = 'red') 

```
